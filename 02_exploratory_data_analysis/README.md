> :warning: Порой темные электрические силы мешают GitHub корректно отображать файлы формата `ipynb`. Если такое случилось и в этот раз, то можно просмотреть код проекта в nbviewer.jupyter.org по [этой ссылке](https://nbviewer.jupyter.org/github/konstantin-samsonov/education_praktikum.yandex/blob/master/02_exploratory_data_analysis/exploratory_data_analysis.ipynb) 

# Продажа квартир в Санкт-Петербурге — анализ рынка недвижимости

## Задача 
Используя данные сервиса Яндекс.Недвижимость, определить рыночную стоимость объектов недвижимости и типичные параметры квартир

## Описание данных
- `airports_nearest` — расстояние до ближайшего аэропорта в метрах (м)
- `balcony` — число балконов
- `ceiling_height` — высота потолков (м)
- `cityCenters_nearest` — расстояние до центра города (м)
- `days_exposition` — сколько дней было размещено объявление (от публикации до снятия)
- `first_day_exposition` — дата публикации
- `floor` — этаж
- `floors_total` — всего этажей в доме
- `is_apartment` — апартаменты (булев тип), апартаменты — это нежилые помещения, не относящиеся к жилому фонду, но имеющие необходимые условия для проживания.
- `kitchen_area` — площадь кухни в квадратных метрах (м²)
- `last_price` — цена на момент снятия с публикации
- `living_areaм` — жилая площадь в квадратных метрах(м²)
- `locality_name` — название населённого пункта
- `open_plan` — свободная планировка (булев тип)
- `parks_around3000` — число парков в радиусе 3 км
- `parks_nearest` — расстояние до ближайшего парка (м)
- `ponds_around3000` — число водоёмов в радиусе 3 км
- `ponds_nearest` — расстояние до ближайшего водоёма (м)
- `rooms` — число комнат
- `studio` — квартира-студия (булев тип)
- `total_area` — площадь квартиры в квадратных метрах (м²)
- `total_images` — число фотографий квартиры в объявлении  

## Структура проекта  
- Импорт библиотек и загрузка данных
- Предобработка данных
    - обработка пропусков
    - расчет дополнительных метрик
- Исследовательский анализ данных
- Выявление факторов влияющих на стоимость квартиры


## Итоговый вывод
В процессе решения поставленной задачи были сделаны следующие выводы и наблюдения:

Возможно, что у пользователей сервиса есть какие-то сложности с заполнением данных. Делаю такое предположение по косвенным уликам, но все же:
- доля квартир типа «студия» составляет меньше 1% (149 значений). Мне кажется, что это крайне мало. 
- часть записей не содержит этажность дома
- высота потолков не указана почтив в 40% данных. Где-то это просто пропуски. Где-то это явный результат ошибки ввода данных. Например, пользователь хотел ввести 2.5 метров, но ошибся и ввел 25.0 метров. 
- Много пропусков содержалось и в переменных `kitchen_area`, `living_area`
- Присутствуют аномально большие значения в метриках типа `last_price`,`total_area`,`rooms`.
Часть пропусков удалось восстановить и заменить на релевантные значения, но не всегда это было возможно. Считаю, что стоит провести аудит пользовательского пути и доработать формы ввода данных. Может быть сделать какие-то поля обязательными к заполнению? Или как-то иначе мотивировать пользователя вводить корректную информацию. 

Так же были обнаружены пропуски в результате технических ошибок (или сбоев ). 
- `cityCenters_nearest` содержит большое количество пропусков. Так как эта метрика заполняется автоматически, то необходимо проверить алгоритм заполнения. Возможно что-то поломалось.
- `days_exposition` - отсутствует 13% данных (3 162) и это странно. При анализе данной переменной было выявлено, что количество объявлений у которых отсутствуют значения стали появляться в 2019 году. 

Отдельно хочется отметить, что начина с 2014 года медианное время продажи падает, а количество объявлений увеличивается. Правда, из-за ошибки с `days_exposition` в 2019 году (см. выше) нет возможности корректно проанализировать динамику продаж за 2019г. 

В результате анализа данных был обнаружен интересный факт. Похоже, что покупатели не очень любят первый/последний этаж. Стоимость квартир на этих этажах меньше. Это может говорить о том, что продавцы занижают стоимость, так как признают свой "товар" не очень ликвидным. Проще говоря данные подтверждают известный в народе факт: "первый последний не предлагать ..." 

Закономерностей между ценой продажи квартиры и днем/месяцем подачи объявления нет. А вот год подачи явно влияет на цену. Начиная с 2014 цена на квартиры падает. Падает как медиана, так и среднее значение стоимости. 

Есть явное разделение на центральную часть Санкт-Петербурга и все остальное. Граница проходит в радиусе 8км от центра. Это очень хорошо видно при анализе цены и расстояния. 

Если сравнивать основные метрики влияющие на цену (об этом ниже) между центральной частью города (до 8км от центра) и всем остальным набором данных, то проявляются следующие закономерности:
- квартир в центре продают меньше чем в целом и они дороже (что логично). 
- в большинстве случаев в центре города продаются 2х и 3х комнатные квартиры. Третье место занимают однушки. А вот в глобальном наборе данных история совершенно обратная. Лидер продаж это однокомнатная квартира и уже потом только 2х и 3х комнатные квартиры. 


Максимальное влияние на стоимость квартиры (что в центре города, что по всему городу) имеет метрика `total_area`. Коэффициент корреляции 0.78.   

Следующая, по влиянию, идет метрика `rooms` (0.49). Что логично, так как количество комнат можно считать первой производной от общей площади квартиры.   

А вот удаленность от центра имеет меньшее влияние на стоимость. Коэффициент корреляции всего -0.009. Правда стоит сделать оговорку. Предоставленный набор данных содержит 5433 пропусков по метрике `cityCenters_nearest` (23%). Возможно, что отсутствующие данные могли бы показать другой коэффициент корреляции. 